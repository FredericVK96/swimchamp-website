<!DOCTYPE html>
<html>
<head>
    <title>Simple SwimChamp Favicon Generator</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; }
        .logo-preview { text-align: center; margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .favicon-item { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; text-align: center; }
        .btn { background: #0EA5E9; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; margin: 5px; }
        .btn:hover { background: #0284C7; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .status { padding: 15px; margin: 10px 0; border-radius: 6px; }
        .success { background: #e8f5e8; color: #2e7d2e; }
        .error { background: #ffebee; color: #c62828; }
        canvas { border: 2px solid #0EA5E9; border-radius: 4px; margin: 10px; }
        .instructions { background: #f0f8ff; padding: 20px; border-radius: 8px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèä‚Äç‚ôÇÔ∏è Simple SwimChamp Favicon Generator</h1>
        
        <div class="instructions">
            <h3>üìã Instructions:</h3>
            <div class="error" style="margin-bottom: 15px;">
                <strong>‚ö†Ô∏è IMPORTANT:</strong> You need to run a local server for this to work!<br>
                <strong>Option 1:</strong> Python: <code>python -m http.server 8000</code><br>
                <strong>Option 2:</strong> Node.js: <code>npx http-server</code><br>
                <strong>Option 3:</strong> Use the alternative method below ‚¨áÔ∏è
            </div>
            <ol>
                <li>Run local server in this directory</li>
                <li>Open <code>http://localhost:8000/simple-favicon-generator.html</code></li>
                <li>Click "Load Logo and Generate"</li>
                <li>Right-click on each canvas image below</li>
                <li>Select "Save image as..."</li>
                <li>Save with the exact filename shown (e.g. favicon-16x16.png)</li>
                <li>Save all files to your <code>assets/images/</code> folder</li>
            </ol>
        </div>
        
        <div class="logo-preview">
            <h3>Original Logo:</h3>
            <img id="source-logo" src="assets/images/swimchamp-logo.png" alt="SwimChamp Logo" 
                 style="max-width: 200px; max-height: 100px; border: 1px solid #ddd;"
                 onload="console.log('‚úÖ Logo loaded successfully')" 
                 onerror="console.log('‚ùå Logo failed to load')">
            <p style="font-size: 12px; color: #666; margin-top: 10px;">
                If logo doesn't show above, you need to run a local server (see instructions below)
            </p>
        </div>
        
        <div id="status" class="status" style="display: none;"></div>

        <button id="generate-btn" class="btn" onclick="loadAndGenerate()" style="font-size: 16px; padding: 15px 30px;">
            üé® Load Logo and Generate All Favicons
        </button>

        <div id="favicon-container">
            <!-- Generated favicons will appear here -->
        </div>
    </div>

    <script>
        const faviconSizes = [
            { size: 16, name: 'favicon-16x16.png' },
            { size: 32, name: 'favicon-32x32.png' },
            { size: 48, name: 'favicon-48x48.png' },
            { size: 96, name: 'favicon-96x96.png' },
            { size: 180, name: 'apple-touch-icon.png' },
            { size: 192, name: 'android-chrome-192x192.png' },
            { size: 512, name: 'android-chrome-512x512.png' }
        ];

        function showStatus(message, isError = false) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = isError ? 'status error' : 'status success';
            statusDiv.style.display = 'block';
        }

        function loadAndGenerate() {
            const generateBtn = document.getElementById('generate-btn');
            const container = document.getElementById('favicon-container');
            
            generateBtn.disabled = true;
            generateBtn.textContent = 'üîÑ Loading...';
            showStatus('Loading logo and generating favicons...');
            
            // Create a new image to ensure it's loaded
            const img = new Image();
            img.onload = function() {
                try {
                    container.innerHTML = '';
                    
                    faviconSizes.forEach(config => {
                        createFaviconCanvas(img, config, container);
                    });
                    
                    showStatus('‚úÖ All favicons generated! Right-click each image and "Save image as..." with the filename shown.');
                    generateBtn.textContent = '‚úÖ Generated! (Click to regenerate)';
                    generateBtn.disabled = false;
                    
                } catch (error) {
                    console.error('Generation error:', error);
                    showStatus('‚ùå Error generating favicons: ' + error.message, true);
                    generateBtn.textContent = 'üé® Try Again';
                    generateBtn.disabled = false;
                }
            };
            
            img.onerror = function() {
                showStatus('‚ùå Could not load the logo image. Check if assets/images/swimchamp-logo.png exists.', true);
                generateBtn.textContent = 'üé® Try Again';
                generateBtn.disabled = false;
            };
            
            // Load the image with proper error handling
            img.crossOrigin = 'anonymous';
            img.src = 'assets/images/swimchamp-logo.png?' + Date.now(); // Add timestamp to avoid cache
        }

        function createFaviconCanvas(sourceImg, config, container) {
            // Create favicon container
            const faviconDiv = document.createElement('div');
            faviconDiv.className = 'favicon-item';
            
            // Create canvas
            const canvas = document.createElement('canvas');
            canvas.width = config.size;
            canvas.height = config.size;
            canvas.style.width = Math.min(config.size, 128) + 'px';
            canvas.style.height = Math.min(config.size, 128) + 'px';
            
            const ctx = canvas.getContext('2d');
            
            // Debug: Log image dimensions
            console.log(`Creating ${config.size}x${config.size} favicon from image:`, sourceImg.width, 'x', sourceImg.height);
            
            // Fill with white background
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, config.size, config.size);
            
            // Verify image has dimensions
            if (sourceImg.width === 0 || sourceImg.height === 0) {
                console.error('Source image has no dimensions!');
                ctx.fillStyle = '#ff0000';
                ctx.fillRect(0, 0, config.size, config.size);
                ctx.fillStyle = '#ffffff';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('ERROR', config.size/2, config.size/2);
                return canvas;
            }
            
            // Calculate logo size (85% of canvas, maintaining aspect ratio)
            const maxSize = config.size * 0.85;
            const logoRatio = sourceImg.naturalWidth / sourceImg.naturalHeight;
            
            let logoWidth, logoHeight;
            if (logoRatio > 1) {
                // Logo is wider
                logoWidth = maxSize;
                logoHeight = maxSize / logoRatio;
            } else {
                // Logo is taller
                logoHeight = maxSize;
                logoWidth = maxSize * logoRatio;
            }
            
            // Center the logo
            const x = (config.size - logoWidth) / 2;
            const y = (config.size - logoHeight) / 2;
            
            console.log(`Drawing logo at (${x}, ${y}) with size ${logoWidth}x${logoHeight}`);
            
            // Draw with high quality
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';
            
            try {
                ctx.drawImage(sourceImg, x, y, logoWidth, logoHeight);
                console.log(`‚úÖ Successfully drew ${config.size}x${config.size} favicon`);
            } catch (error) {
                console.error(`‚ùå Error drawing ${config.size}x${config.size} favicon:`, error);
                // Draw error indicator
                ctx.fillStyle = '#ff0000';
                ctx.fillRect(10, 10, config.size-20, config.size-20);
            }
            
            // Return canvas for any further processing
            // Add to container
            faviconDiv.innerHTML = `
                <h4>${config.size}√ó${config.size} pixels</h4>
                <p style="font-weight: bold; color: #0EA5E9;">Save as: ${config.name}</p>
            `;
            faviconDiv.appendChild(canvas);
            faviconDiv.innerHTML += `
                <p style="font-size: 12px; color: #666; margin-top: 10px;">
                    Right-click the image above ‚Üí "Save image as..." ‚Üí ${config.name}
                </p>
            `;
            
            container.appendChild(faviconDiv);
        }
    </script>
</body>
</html>