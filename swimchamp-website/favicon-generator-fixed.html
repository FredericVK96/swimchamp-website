<!DOCTYPE html>
<html>
<head>
    <title>SwimChamp Favicon Generator - Fixed</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; }
        .favicon-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0; }
        .favicon-item { text-align: center; padding: 20px; border: 2px solid #ddd; border-radius: 8px; background: #f9f9f9; }
        .logo-preview { text-align: center; margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .btn { background: #0EA5E9; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; margin: 5px; text-decoration: none; display: inline-block; }
        .btn:hover { background: #0284C7; }
        .status { padding: 15px; margin: 10px 0; border-radius: 6px; }
        .success { background: #e8f5e8; color: #2e7d2e; }
        .error { background: #ffebee; color: #c62828; }
        canvas { border: 2px solid #0EA5E9; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèä‚Äç‚ôÇÔ∏è SwimChamp Favicon Generator (Fixed)</h1>
        
        <div class="logo-preview">
            <h3>Your Logo:</h3>
            <img id="source-logo" src="assets/images/swimchamp-logo.png" alt="SwimChamp Logo" 
                 style="max-width: 300px; max-height: 150px; border: 1px solid #ddd;"
                 crossorigin="anonymous">
        </div>
        
        <div id="status" class="status success" style="display: none;">
            ‚úÖ Ready to generate favicons!
        </div>

        <button class="btn" onclick="generateAllFavicons()" style="font-size: 16px; padding: 15px 30px;">
            üé® Generate All Favicon Sizes
        </button>

        <div class="favicon-grid" id="favicon-container">
            <!-- Favicons will appear here -->
        </div>
    </div>

    <script>
        const faviconSizes = [
            { size: 16, name: 'favicon-16x16.png', title: '16√ó16 Browser Tab' },
            { size: 32, name: 'favicon-32x32.png', title: '32√ó32 Browser Tab' },
            { size: 48, name: 'favicon-48x48.png', title: '48√ó48 Windows' },
            { size: 96, name: 'favicon-96x96.png', title: '96√ó96 Desktop' },
            { size: 180, name: 'apple-touch-icon.png', title: '180√ó180 iOS' },
            { size: 192, name: 'android-chrome-192x192.png', title: '192√ó192 Android' },
            { size: 512, name: 'android-chrome-512x512.png', title: '512√ó512 Splash' }
        ];

        let sourceLogo = null;

        // Wait for logo to load
        document.getElementById('source-logo').addEventListener('load', function() {
            sourceLogo = this;
            document.getElementById('status').style.display = 'block';
            document.getElementById('status').textContent = '‚úÖ Logo loaded! Ready to generate favicons.';
        });

        function generateAllFavicons() {
            if (!sourceLogo || !sourceLogo.complete) {
                alert('‚ö†Ô∏è Logo not loaded yet. Please wait a moment and try again.');
                return;
            }

            const container = document.getElementById('favicon-container');
            container.innerHTML = '<div style="text-align: center; padding: 20px;">üîÑ Generating all favicon sizes...</div>';
            
            // Small delay to show loading message
            setTimeout(() => {
                container.innerHTML = '';
                
                faviconSizes.forEach(config => {
                    createFavicon(config, container);
                });
            }, 500);
        }

        function createFavicon(config, container) {
            // Create container for this favicon
            const faviconDiv = document.createElement('div');
            faviconDiv.className = 'favicon-item';
            faviconDiv.innerHTML = `
                <h4>${config.title}</h4>
                <div style="margin: 15px 0;">
                    <canvas width="${config.size}" height="${config.size}" 
                            style="width: ${Math.min(config.size, 100)}px; height: ${Math.min(config.size, 100)}px;"></canvas>
                </div>
                <button class="btn download-btn" data-filename="${config.name}">
                    üíæ Download ${config.name}
                </button>
            `;
            
            container.appendChild(faviconDiv);
            
            // Get the canvas and draw the logo
            const canvas = faviconDiv.querySelector('canvas');
            const ctx = canvas.getContext('2d');
            
            // Fill with white background
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, config.size, config.size);
            
            // Calculate logo dimensions (maintain aspect ratio, 85% of canvas)
            const maxSize = config.size * 0.85;
            const logoRatio = sourceLogo.naturalWidth / sourceLogo.naturalHeight;
            
            let logoWidth, logoHeight;
            if (logoRatio > 1) {
                logoWidth = maxSize;
                logoHeight = maxSize / logoRatio;
            } else {
                logoHeight = maxSize;
                logoWidth = maxSize * logoRatio;
            }
            
            // Center the logo
            const x = (config.size - logoWidth) / 2;
            const y = (config.size - logoHeight) / 2;
            
            // Draw logo with high quality
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';
            ctx.drawImage(sourceLogo, x, y, logoWidth, logoHeight);
            
            // Setup download
            const downloadBtn = faviconDiv.querySelector('.download-btn');
            downloadBtn.addEventListener('click', function() {
                canvas.toBlob(function(blob) {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = config.name;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    // Visual feedback
                    downloadBtn.textContent = '‚úÖ Downloaded!';
                    downloadBtn.style.background = '#4CAF50';
                    setTimeout(() => {
                        downloadBtn.textContent = `üíæ Download ${config.name}`;
                        downloadBtn.style.background = '#0EA5E9';
                    }, 2000);
                });
            });
        }
    </script>
</body>
</html>